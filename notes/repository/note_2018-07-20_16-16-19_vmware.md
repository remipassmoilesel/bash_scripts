# Memo VMWare

## Se connecter à une machine VMWare sous Linux en client lourd

Voir: [VMWare Remote Console](https://kb.vmware.com/s/article/2091284)


### Installation du client

Le meilleur client à ce jour reste le client VSphere Windaube.

Se rendre dans VSphere, choisir une VM, puis aller dans Résumé et cliquer sur Télécharger la console distante.

Ensuite:

	$ /usr/bin/vmrc -U "domain\username" -H host-without-port.fr


## Client VSphere pour Windaube

Téléchargement:

	http://vsphereclient.vmware.com/vsphereclient/2/5/0/2/2/2/2/VMware-viclient-all-6.0.0-2502222.exe


## Créer un template vmware Ubuntu Bionic

Dans l'interface VMWare:

1. Créer une VM
1. Uploader un iso dans une banque de données
1. Clic droit sur la machine > Editer les paramètres
1. Materiel > Lecteur CD / DVD > Activer "Connecter lors de la mise sous tension" > Fichier ISO banque de données > Choisir le ISO
1. Options > Avancé > Options de démarrage > "Au prochain démarrage ... forcer l'entrée dans l'écran ... BIOS"


Se connecter en SSH puis configurer les listes APT:

	$ sudo vim /etc/apt/sources.list

	+ universe restricted

Enlever cloud-init, installer des helpers:

	$ sudo apt remove cloud-init
	$ sudo apt update && sudo apt install open-vm-tools rsync git htop ncdu

Configurer le réseau:

	$ cd /etc/netplan
	$ rm 50.cloud-init...
	$ vim network.yaml

	...

	$ netplan apply

Copier sa clef SSH sur la machine puis configurer SSH:

	$ vim /etc/ssh/sshd_config

	PermitRootLogin prohibit-password
	PasswordAuthentication no

	$ sudo systemctl restart ssh


